import{b as re,x as _e,s as q,_ as ye,u as ce,J as Me,w as we,P as Ee,m as tt,K as $e,L as lt,g as Ue,M as ot,N as st,O as nt,d as at,Q as je,h as Oe,c as it,R as rt,r as ct,S as ut,U as Be,V as dt,k as Ne,W as ft,X as vt,i as Fe,Y as mt,Z as gt,$ as pt}from"./el-popper-Cc3e5aKF.js";import{E as yt,a as ht,b as He}from"./el-checkbox-DbOIK0lJ.js";import{u as bt,U as We,g as _t,a as Ct,b as wt,c as kt,d as It,l as St,e as Et,I as ze,E as Lt,f as $t,h as Tt,i as Pt,j as me}from"./ImageInfo-CQoquW0f.js";import{d as B,i as Te,b as $,B as Ye,c as G,o as k,w as h,r as U,f as he,n as z,u as a,I as Ie,N as Le,J as C,s as xt,g as L,l as Ce,C as At,q as Dt,M as Pe,e as A,E as w,O as ie,H as ge,P as Mt,j as pe,Q as Ot,k as Bt,A as Nt,z as Ke,a as Ft,T as zt,m as Ve,x as Vt,R as Rt,y as Ut,p as Xe,S as jt,U as Ht,h as Wt,V as qe,F as xe,K as Ae,_ as Ge,G as Q,W as Yt}from"./index-C1J_mbNU.js";const Kt=re({tag:{type:String,default:"div"},span:{type:Number,default:24},offset:{type:Number,default:0},pull:{type:Number,default:0},push:{type:Number,default:0},xs:{type:q([Number,Object]),default:()=>_e({})},sm:{type:q([Number,Object]),default:()=>_e({})},md:{type:q([Number,Object]),default:()=>_e({})},lg:{type:q([Number,Object]),default:()=>_e({})},xl:{type:q([Number,Object]),default:()=>_e({})}}),Je=Symbol("rowContextKey"),Xt=B({name:"ElCol"}),qt=B({...Xt,props:Kt,setup(t){const n=t,{gutter:l}=Te(Je,{gutter:$(()=>0)}),d=ce("col"),o=$(()=>{const s={};return l.value&&(s.paddingLeft=s.paddingRight=`${l.value/2}px`),s}),u=$(()=>{const s=[];return["span","offset","pull","push"].forEach(f=>{const S=n[f];Me(S)&&(f==="span"?s.push(d.b(`${n[f]}`)):S>0&&s.push(d.b(`${f}-${n[f]}`)))}),["xs","sm","md","lg","xl"].forEach(f=>{Me(n[f])?s.push(d.b(`${f}-${n[f]}`)):Ye(n[f])&&Object.entries(n[f]).forEach(([S,T])=>{s.push(S!=="span"?d.b(`${f}-${S}-${T}`):d.b(`${f}-${T}`))})}),l.value&&s.push(d.is("guttered")),[d.b(),s]});return(s,p)=>(k(),G(Ie(s.tag),{class:z(a(u)),style:he(a(o))},{default:h(()=>[U(s.$slots,"default")]),_:3},8,["class","style"]))}});var Gt=ye(qt,[["__file","col.vue"]]);const Jt=we(Gt),Ze=t=>{if(!t)return{onClick:Le,onMousedown:Le,onMouseup:Le};let n=!1,l=!1;return{onClick:s=>{n&&l&&t(s),n=l=!1},onMousedown:s=>{n=s.target===s.currentTarget},onMouseup:s=>{l=s.target===s.currentTarget}}},Zt=re({mask:{type:Boolean,default:!0},customMaskEvent:Boolean,overlayClass:{type:q([String,Array,Object])},zIndex:{type:q([String,Number])}}),Qt={click:t=>t instanceof MouseEvent},el="overlay";var tl=B({name:"ElOverlay",props:Zt,emits:Qt,setup(t,{slots:n,emit:l}){const d=ce(el),o=g=>{l("click",g)},{onClick:u,onMousedown:s,onMouseup:p}=Ze(t.customMaskEvent?void 0:o);return()=>t.mask?C("div",{class:[d.b(),t.overlayClass],style:{zIndex:t.zIndex},onClick:u,onMousedown:s,onMouseup:p},[U(n,"default")],Ee.STYLE|Ee.CLASS|Ee.PROPS,["onClick","onMouseup","onMousedown"]):xt("div",{class:t.overlayClass,style:{zIndex:t.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[U(n,"default")])}});const ll=tl,Qe=Symbol("dialogInjectionKey"),Re="dialog-fade",et=re({center:Boolean,alignCenter:{type:Boolean,default:void 0},closeIcon:{type:tt},draggable:{type:Boolean,default:void 0},overflow:{type:Boolean,default:void 0},fullscreen:Boolean,headerClass:String,bodyClass:String,footerClass:String,showClose:{type:Boolean,default:!0},title:{type:String,default:""},ariaLevel:{type:String,default:"2"}}),ol={close:()=>!0},sl=(t,n,l,d)=>{const o={offsetX:0,offsetY:0},u=L(!1),s=(y,r)=>{if(t.value){const{offsetX:D,offsetY:M}=o,O=t.value.getBoundingClientRect(),E=O.left,b=O.top,V=O.width,j=O.height,H=document.documentElement.clientWidth,ee=document.documentElement.clientHeight,J=-E+D,W=-b+M,N=H-E-V+D,Z=ee-b-(j<ee?j:0)+M;d?.value||(y=Math.min(Math.max(y,J),N),r=Math.min(Math.max(r,W),Z)),o.offsetX=y,o.offsetY=r,t.value.style.transform=`translate(${$e(y)}, ${$e(r)})`}},p=y=>{const r=y.clientX,D=y.clientY,{offsetX:M,offsetY:O}=o,E=V=>{u.value||(u.value=!0);const j=M+V.clientX-r,H=O+V.clientY-D;s(j,H)},b=()=>{u.value=!1,document.removeEventListener("mousemove",E),document.removeEventListener("mouseup",b)};document.addEventListener("mousemove",E),document.addEventListener("mouseup",b)},g=()=>{n.value&&t.value&&(n.value.addEventListener("mousedown",p),window.addEventListener("resize",T))},f=()=>{n.value&&t.value&&(n.value.removeEventListener("mousedown",p),window.removeEventListener("resize",T))},S=()=>{o.offsetX=0,o.offsetY=0,t.value&&(t.value.style.transform="")},T=()=>{const{offsetX:y,offsetY:r}=o;s(y,r)};return Ce(()=>{At(()=>{l.value?g():f()})}),Dt(()=>{f()}),{isDragging:u,resetPosition:S,updatePosition:T}},nl=(...t)=>n=>{t.forEach(l=>{Pe(l)?l(n):l.value=n})},al=B({name:"ElDialogContent"}),il=B({...al,props:et,emits:ol,setup(t,{expose:n}){const l=t,{t:d}=bt(),{Close:o}=lt,{dialogRef:u,headerRef:s,bodyId:p,ns:g,style:f}=Te(Qe),{focusTrapRef:S}=Te(ot),T=nl(S,u),y=$(()=>!!l.draggable),r=$(()=>!!l.overflow),{resetPosition:D,updatePosition:M,isDragging:O}=sl(u,s,y,r),E=$(()=>[g.b(),g.is("fullscreen",l.fullscreen),g.is("draggable",y.value),g.is("dragging",O.value),g.is("align-center",!!l.alignCenter),{[g.m("center")]:l.center}]);return n({resetPosition:D,updatePosition:M}),(b,V)=>(k(),A("div",{ref:a(T),class:z(a(E)),style:he(a(f)),tabindex:"-1"},[w("header",{ref_key:"headerRef",ref:s,class:z([a(g).e("header"),b.headerClass,{"show-close":b.showClose}])},[U(b.$slots,"header",{},()=>[w("span",{role:"heading","aria-level":b.ariaLevel,class:z(a(g).e("title"))},ge(b.title),11,["aria-level"])]),b.showClose?(k(),A("button",{key:0,"aria-label":a(d)("el.dialog.close"),class:z(a(g).e("headerbtn")),type:"button",onClick:j=>b.$emit("close")},[C(a(Ue),{class:z(a(g).e("close"))},{default:h(()=>[(k(),G(Ie(b.closeIcon||a(o))))]),_:1},8,["class"])],10,["aria-label","onClick"])):ie("v-if",!0)],2),w("div",{id:a(p),class:z([a(g).e("body"),b.bodyClass])},[U(b.$slots,"default")],10,["id"]),b.$slots.footer?(k(),A("footer",{key:0,class:z([a(g).e("footer"),b.footerClass])},[U(b.$slots,"footer")],2)):ie("v-if",!0)],6))}});var rl=ye(il,[["__file","dialog-content.vue"]]);const cl=re({...et,appendToBody:Boolean,appendTo:{type:nt.to.type,default:"body"},beforeClose:{type:q(Function)},destroyOnClose:Boolean,closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},modalPenetrable:Boolean,openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},top:{type:String},modelValue:Boolean,modalClass:String,headerClass:String,bodyClass:String,footerClass:String,width:{type:[String,Number]},zIndex:{type:Number},trapFocus:Boolean,headerAriaLevel:{type:String,default:"2"},transition:{type:q([String,Object]),default:void 0}}),ul={open:()=>!0,opened:()=>!0,close:()=>!0,closed:()=>!0,[We]:t=>st(t),openAutoFocus:()=>!0,closeAutoFocus:()=>!0},dl=(t,n={})=>{Mt(t)||at("[useLockscreen]","You need to pass a ref param to this function");const l=n.ns||ce("popup"),d=$(()=>l.bm("parent","hidden"));if(!je||Oe(document.body,d.value))return;let o=0,u=!1,s="0";const p=()=>{setTimeout(()=>{typeof document>"u"||u&&document&&(document.body.style.width=s,ct(document.body,d.value))},200)};pe(t,g=>{if(!g){p();return}u=!Oe(document.body,d.value),u&&(s=document.body.style.width,it(document.body,d.value)),o=_t(l.namespace.value);const f=document.documentElement.clientHeight<document.body.scrollHeight,S=rt(document.body,"overflowY");o>0&&(f||S==="scroll")&&u&&(document.body.style.width=`calc(100% - ${o}px)`)}),Ot(()=>p())},fl=(t,n)=>{var l;const o=Bt().emit,{nextZIndex:u}=ut();let s="";const p=Be(),g=Be(),f=L(!1),S=L(!1),T=L(!1),y=L((l=t.zIndex)!=null?l:u());let r,D;const M=Ct(),O=$(()=>{var i,_;return(_=(i=M.value)==null?void 0:i.namespace)!=null?_:dt}),E=$(()=>{var i;return(i=M.value)==null?void 0:i.dialog}),b=$(()=>{const i={},_=`--${O.value}-dialog`;return t.fullscreen||(t.top&&(i[`${_}-margin-top`]=t.top),t.width&&(i[`${_}-width`]=$e(t.width))),i}),V=$(()=>{var i,_,x;return((x=(_=t.draggable)!=null?_:(i=E.value)==null?void 0:i.draggable)!=null?x:!1)&&!t.fullscreen}),j=$(()=>{var i,_,x;return(x=(_=t.alignCenter)!=null?_:(i=E.value)==null?void 0:i.alignCenter)!=null?x:!1}),H=$(()=>{var i,_,x;return(x=(_=t.overflow)!=null?_:(i=E.value)==null?void 0:i.overflow)!=null?x:!1}),ee=$(()=>j.value?{display:"flex"}:{}),J=$(()=>{var i,_,x;const ae=(x=(_=t.transition)!=null?_:(i=E.value)==null?void 0:i.transition)!=null?x:Re,te={name:ae,onAfterEnter:W,onBeforeLeave:Z,onAfterLeave:N};if(Ye(ae)){const F={...ae},Y=(R,I)=>X=>{Nt(R)?R.forEach(le=>{Pe(le)&&le(X)}):Pe(R)&&R(X),I()};return F.onAfterEnter=Y(F.onAfterEnter,W),F.onBeforeLeave=Y(F.onBeforeLeave,Z),F.onAfterLeave=Y(F.onAfterLeave,N),F.name||(F.name=Re),F}return te});function W(){o("opened")}function N(){o("closed"),o(We,!1),t.destroyOnClose&&(T.value=!1)}function Z(){o("close")}function ue(){D?.(),r?.(),t.openDelay&&t.openDelay>0?{stop:r}=Ne(()=>ke(),t.openDelay):ke()}function v(){r?.(),D?.(),t.closeDelay&&t.closeDelay>0?{stop:D}=Ne(()=>be(),t.closeDelay):be()}function de(){function i(_){_||(S.value=!0,f.value=!1)}t.beforeClose?t.beforeClose(i):v()}function fe(){t.closeOnClickModal&&de()}function ke(){je&&(f.value=!0)}function be(){f.value=!1}function Se(){o("openAutoFocus")}function c(){o("closeAutoFocus")}function e(i){var _;((_=i.detail)==null?void 0:_.focusReason)==="pointer"&&i.preventDefault()}t.lockScroll&&dl(f);function m(){t.closeOnPressEscape&&de()}return pe(()=>t.zIndex,()=>{var i;y.value=(i=t.zIndex)!=null?i:u()}),pe(()=>t.modelValue,i=>{var _;i?(S.value=!1,ue(),T.value=!0,y.value=(_=t.zIndex)!=null?_:u(),Ke(()=>{o("open"),n.value&&(n.value.parentElement.scrollTop=0,n.value.parentElement.scrollLeft=0,n.value.scrollTop=0)})):f.value&&v()}),pe(()=>t.fullscreen,i=>{n.value&&(i?(s=n.value.style.transform,n.value.style.transform=""):n.value.style.transform=s)}),Ce(()=>{t.modelValue&&(f.value=!0,T.value=!0,ue())}),{afterEnter:W,afterLeave:N,beforeLeave:Z,handleClose:de,onModalClick:fe,close:v,doClose:be,onOpenAutoFocus:Se,onCloseAutoFocus:c,onCloseRequested:m,onFocusoutPrevented:e,titleId:p,bodyId:g,closed:S,style:b,overlayDialogStyle:ee,rendered:T,visible:f,zIndex:y,transitionConfig:J,_draggable:V,_alignCenter:j,_overflow:H}},vl=B({name:"ElDialog",inheritAttrs:!1}),ml=B({...vl,props:cl,emits:ul,setup(t,{expose:n}){const l=t,d=Ft();wt({scope:"el-dialog",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/dialog.html#slots"},$(()=>!!d.title));const o=ce("dialog"),u=L(),s=L(),p=L(),{visible:g,titleId:f,bodyId:S,style:T,overlayDialogStyle:y,rendered:r,transitionConfig:D,zIndex:M,_draggable:O,_alignCenter:E,_overflow:b,handleClose:V,onModalClick:j,onOpenAutoFocus:H,onCloseAutoFocus:ee,onCloseRequested:J,onFocusoutPrevented:W}=fl(l,u);Xe(Qe,{dialogRef:u,headerRef:s,bodyId:S,ns:o,rendered:r,style:T});const N=Ze(j),Z=$(()=>l.modalPenetrable&&!l.modal&&!l.fullscreen);return n({visible:g,dialogContentRef:p,resetPosition:()=>{var v;(v=p.value)==null||v.resetPosition()},handleClose:V}),(v,de)=>(k(),G(a(vt),{to:v.appendTo,disabled:v.appendTo!=="body"?!1:!v.appendToBody},{default:h(()=>[C(zt,Ve(a(D),{persisted:""}),{default:h(()=>{var fe;return[Vt(C(a(ll),{"custom-mask-event":"",mask:v.modal,"overlay-class":[(fe=v.modalClass)!=null?fe:"",`${a(o).namespace.value}-modal-dialog`,a(o).is("penetrable",a(Z))],"z-index":a(M)},{default:h(()=>[w("div",{role:"dialog","aria-modal":"true","aria-label":v.title||void 0,"aria-labelledby":v.title?void 0:a(f),"aria-describedby":a(S),class:z(`${a(o).namespace.value}-overlay-dialog`),style:he(a(y)),onClick:a(N).onClick,onMousedown:a(N).onMousedown,onMouseup:a(N).onMouseup},[C(a(ft),{loop:"",trapped:a(g),"focus-start-el":"container",onFocusAfterTrapped:a(H),onFocusAfterReleased:a(ee),onFocusoutPrevented:a(W),onReleaseRequested:a(J)},{default:h(()=>[a(r)?(k(),G(rl,Ve({key:0,ref_key:"dialogContentRef",ref:p},v.$attrs,{center:v.center,"align-center":a(E),"close-icon":v.closeIcon,draggable:a(O),overflow:a(b),fullscreen:v.fullscreen,"header-class":v.headerClass,"body-class":v.bodyClass,"footer-class":v.footerClass,"show-close":v.showClose,title:v.title,"aria-level":v.headerAriaLevel,onClose:a(V)}),Rt({header:h(()=>[v.$slots.title?U(v.$slots,"title",{key:1}):U(v.$slots,"header",{key:0,close:a(V),titleId:a(f),titleClass:a(o).e("title")})]),default:h(()=>[U(v.$slots,"default")]),_:2},[v.$slots.footer?{name:"footer",fn:h(()=>[U(v.$slots,"footer")])}:void 0]),1040,["center","align-center","close-icon","draggable","overflow","fullscreen","header-class","body-class","footer-class","show-close","title","aria-level","onClose"])):ie("v-if",!0)]),_:3},8,["trapped","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])],46,["aria-label","aria-labelledby","aria-describedby","onClick","onMousedown","onMouseup"])]),_:3},8,["mask","overlay-class","z-index"]),[[Ut,a(g)]])]}),_:3},16)]),_:3},8,["to","disabled"]))}});var gl=ye(ml,[["__file","dialog.vue"]]);const pl=we(gl),yl=re({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},contentPosition:{type:String,values:["left","center","right"],default:"center"},borderStyle:{type:q(String),default:"solid"}}),hl=B({name:"ElDivider"}),bl=B({...hl,props:yl,setup(t){const n=t,l=ce("divider"),d=$(()=>l.cssVar({"border-style":n.borderStyle}));return(o,u)=>(k(),A("div",{class:z([a(l).b(),a(l).m(o.direction)]),style:he(a(d)),role:"separator"},[o.$slots.default&&o.direction!=="vertical"?(k(),A("div",{key:0,class:z([a(l).e("text"),a(l).is(o.contentPosition)])},[U(o.$slots,"default")],2)):ie("v-if",!0)],6))}});var _l=ye(bl,[["__file","divider.vue"]]);const Cl=we(_l),wl=["start","center","end","space-around","space-between","space-evenly"],kl=["top","middle","bottom"],Il=re({tag:{type:String,default:"div"},gutter:{type:Number,default:0},justify:{type:String,values:wl,default:"start"},align:{type:String,values:kl}}),Sl=B({name:"ElRow"}),El=B({...Sl,props:Il,setup(t){const n=t,l=ce("row"),d=$(()=>n.gutter);Xe(Je,{gutter:d});const o=$(()=>{const s={};return n.gutter&&(s.marginRight=s.marginLeft=`-${n.gutter/2}px`),s}),u=$(()=>[l.b(),l.is(`justify-${n.justify}`,n.justify!=="start"),l.is(`align-${n.align}`,!!n.align)]);return(s,p)=>(k(),G(Ie(s.tag),{class:z(a(u)),style:he(a(o))},{default:h(()=>[U(s.$slots,"default")]),_:3},8,["class","style"]))}});var Ll=ye(El,[["__file","row.vue"]]);const $l=we(Ll),Tl=re({type:{type:String,values:["primary","success","info","warning","danger",""],default:""},size:{type:String,values:kt,default:""},truncated:Boolean,lineClamp:{type:[String,Number]},tag:{type:String,default:"span"}}),Pl=B({name:"ElText"}),xl=B({...Pl,props:Tl,setup(t){const n=t,l=L(),d=It(),o=ce("text"),u=$(()=>[o.b(),o.m(n.type),o.m(d.value),o.is("truncated",n.truncated),o.is("line-clamp",!Fe(n.lineClamp))]),s=()=>{var p,g,f,S,T,y,r;if(Ht().title)return;let M=!1;const O=((p=l.value)==null?void 0:p.textContent)||"";if(n.truncated){const E=(g=l.value)==null?void 0:g.offsetWidth,b=(f=l.value)==null?void 0:f.scrollWidth;E&&b&&b>E&&(M=!0)}else if(!Fe(n.lineClamp)){const E=(S=l.value)==null?void 0:S.offsetHeight,b=(T=l.value)==null?void 0:T.scrollHeight;E&&b&&b>E&&(M=!0)}M?(y=l.value)==null||y.setAttribute("title",O):(r=l.value)==null||r.removeAttribute("title")};return Ce(s),jt(s),(p,g)=>(k(),G(Ie(p.tag),{ref_key:"textRef",ref:l,class:z(a(u)),style:he({"-webkit-line-clamp":p.lineClamp})},{default:h(()=>[U(p.$slots,"default")]),_:3},8,["class","style"]))}});var Al=ye(xl,[["__file","text.vue"]]);const Dl=we(Al),K=Wt([{name:"每行6张",num:6},{name:"每行7张",num:7},{name:"每行8张",num:8},{name:"每行9张",num:9},{name:"每行10张",num:10},{name:"每行11张",num:11},{name:"每行12张",num:12}]),Ml={key:0},Ol={class:"image-item"},Bl={key:0,style:{"text-align":"center",padding:"10px",color:"#909399"}},Nl={key:1,style:{"text-align":"center"}},Fl=B({__name:"ImageView",props:{ImageInfo:{},total:{}},setup(t,{expose:n}){const l=L([]);let d=null;const o=u=>{d&&clearTimeout(d),d=setTimeout(()=>{const s=l.value.indexOf(u);s>-1?l.value.splice(s,1):l.value.push(u),d=null},50)};return n({checkList:l}),qe(()=>{d&&clearTimeout(d)}),(u,s)=>{const p=ht,g=He,f=Jt,S=$l,T=yt;return k(),A("div",null,[u.ImageInfo.length!=0?(k(),A("div",Ml,[C(T,{modelValue:l.value,"onUpdate:modelValue":s[0]||(s[0]=y=>l.value=y)},{default:h(()=>[C(S,{gutter:[20,20]},{default:h(()=>[(k(!0),A(xe,null,Ae(u.ImageInfo,y=>(k(),G(f,{xs:12,sm:8,md:6,key:y.id},{default:h(()=>[w("div",Ol,[C(p,{label:y.id,class:"custom-checkbox"},null,8,["label"]),C(g,{onClick:r=>o(y.id),src:y.data,fit:"contain",class:z([{"selected-image":l.value.includes(y.id)},"image-content"]),"hide-on-click-modal":"","preview-teleported":"",lazy:""},null,8,["onClick","src","class"])])]),_:2},1024))),128))]),_:1})]),_:1},8,["modelValue"]),u.total&&u.ImageInfo.length<u.total?(k(),A("div",Bl," 已显示 "+ge(u.ImageInfo.length)+" / "+ge(u.total)+" 张图片 ",1)):ie("",!0)])):(k(),A("div",Nl,[...s[1]||(s[1]=[w("h3",null,"当前选项下暂无图片",-1)])]))])}}}),zl=Ge(Fl,[["__scopeId","data-v-5e515547"]]),Vl={class:"main-container"},Rl={class:"left-panel"},Ul={class:"card-header"},jl={class:"count-number"},Hl={class:"action-bar"},Wl={class:"count-number"},Yl={class:"button-group"},Kl={key:0,class:"loading-more"},Xl={key:1,class:"load-complete"},ql={class:"right-panel"},Gl={class:"selected-list-container"},Jl={key:0,class:"empty-state"},Zl={key:1,class:"selected-items"},Ql={class:"selected-item"},eo={class:"drag-handle"},to={class:"image-name"},lo={class:"stitching-controls"},oo={class:"result-container"},so={id:"canvas",ref:"canvas",width:"1",height:"1",style:{display:"none"}},no={key:1,class:"no-result"},ao=B({__name:"ImageStitching",setup(t){const n=L([]),l=L([]),d=L(""),o=L([]),u=L(20),s=L(1),p=L(!1),g=$(()=>{const e=(s.value-1)*u.value+u.value;return o.value.slice(0,e)}),f=c=>{const e=c.target;e.scrollHeight-e.scrollTop<=e.clientHeight+100&&S()},S=()=>{p.value||g.value.length>=o.value.length||(p.value=!0,setTimeout(()=>{s.value+=1,p.value=!1},200))};pe(o,()=>{s.value=1}),Ce(async()=>{await St(),await Et(),n.value=ze.map((c,e)=>({value:e.toString(),label:c})),l.value=n.value,l.value.length>0&&l.value[0]&&(d.value=l.value[0].value,y(d.value))});const T=c=>{const e=parseInt(c);if(e===0)return me.value;const m=ze[e];return me.value.filter(i=>i.type===m)},y=c=>{const e=T(c);o.value=e},r=L(null),D=()=>{if(r.value&&o.value){const c=new Set(r.value.checkList||[]);o.value.map(m=>m.id).forEach(m=>{c.add(m)}),r.value.checkList=Array.from(c)}},M=()=>{if(r.value&&o.value){const c=new Set(r.value.checkList||[]);new Set(o.value.map(m=>m.id)).forEach(m=>{c.has(m)?c.delete(m):c.add(m)}),r.value.checkList=Array.from(c)}},O=()=>{if(r.value&&o.value){const c=new Set(r.value.checkList||[]);new Set(o.value.map(m=>m.id)).forEach(m=>{c.delete(m)}),r.value.checkList=Array.from(c)}},E=L(!0),b=c=>{console.log("List changed:",c)},V=c=>me.value.find(m=>m.id===c)?.name||"未知",j=c=>{if(!r.value||!r.value.checkList||c<0||c>=r.value.checkList.length)return;const e=r.value.checkList[c];r.value.checkList.splice(c,1);const m=r.value.checkList.indexOf(e);m!==-1&&r.value.checkList.splice(m,1)},H=L(K[0]?.name),ee=L([]);Ce(()=>{ee.value=[...K]});const J=L(!1),W=L(""),N=new Map,Z=c=>{if(N.has(c))return N.get(c);const e=me.value.find(m=>m.id===c);return e?.data?(N.set(c,e.data),e.data):""},ue=()=>{N.clear()};pe(o,ue);let v=null;const de=async()=>{v&&v.abort(),v=new AbortController,J.value=!0,await Ke();try{await fe(v.signal)}catch(c){c.name!=="AbortError"&&console.error("图片拼接失败:",c)}},fe=async c=>{if(c?.aborted)return;const e=document.getElementById("canvas");if(!e)return;const m=e.getContext("2d");if(m)try{if(c?.aborted)return;const i=window.devicePixelRatio||1,_=r?.value?.checkList||[],x=[];for(const P of _){const oe=me.value.find(se=>se.id===P);oe&&x.push(oe)}const F=x.slice(0,100).map(P=>P.data),Y=await Promise.all(F.map(P=>be(P))),R=ke(),I=Y.length;if(I===0)return;let X=0;for(let P=0;P<I;P+=R){const se=Y.slice(P,P+R).reduce((ve,ne)=>ve+ne.naturalWidth,0);se>X&&(X=se)}let le=0;for(let P=0;P<I;P+=R){const oe=Y.slice(P,P+R),se=Math.max(...oe.map(ve=>ve.naturalHeight));le+=se}e.style.width=X+"px",e.style.height=le+"px",e.width=X*i,e.height=le*i,m.scale(i,i),m.fillStyle="#fff",m.fillRect(0,0,X,le);let De=0;for(let P=0;P<I;P+=R){const oe=Y.slice(P,P+R),se=Math.max(...oe.map(ne=>ne.naturalHeight));let ve=0;for(const ne of oe)m.drawImage(ne,ve,De,ne.naturalWidth,ne.naturalHeight),ve+=ne.naturalWidth;De+=se}W.value=e.toDataURL("image/png")}catch(i){console.error("图片加载失败:",i)}},ke=()=>{if(!K[0])return 0;if(!H.value)return K&&K.length>0?K[0].num:6;const c=K.find(e=>e.name===H.value);return c?c.num:K&&K.length>0?K[0].num:6},be=c=>new Promise((e,m)=>{const i=new Image;i.onload=()=>e(i),i.onerror=m,i.src=c}),Se=c=>{if(!r.value?.checkList)return[];const e=r.value.checkList.indexOf(c);return e===-1?[]:[...r.value.checkList.slice(e),...r.value.checkList.slice(0,e)].map(i=>me.value.find(x=>x.id===i)?.data||"").filter(i=>i!=="")};return qe(()=>{v&&v.abort(),ue()}),(c,e)=>{const m=$t,i=Lt,_=Dl,x=Ue,ae=Cl,te=Tt,F=Pt,Y=He,R=pl;return k(),A("div",Vl,[w("div",Rl,[C(F,{shadow:"hover",class:"flex-card"},{header:h(()=>[w("div",Ul,[C(i,{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=I=>d.value=I),placeholder:"请选择",size:"large",onChange:y,class:"category-select"},{default:h(()=>[(k(!0),A(xe,null,Ae(l.value,I=>(k(),G(m,{key:I.value,label:I.label,value:I.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),C(_,{class:"image-count"},{default:h(()=>[e[5]||(e[5]=Q(" 当前分类下共有",-1)),w("span",jl,ge(o.value.length),1),e[6]||(e[6]=Q("张图片 ",-1))]),_:1})]),w("div",null,[C(ae,null,{default:h(()=>[C(x,null,{default:h(()=>[C(a(gt))]),_:1})]),_:1})]),w("div",Hl,[C(_,{class:"hint-text"},{default:h(()=>[e[7]||(e[7]=Q(" 温馨提示：点击图片即可选中，当前共选择 ",-1)),w("span",Wl,ge(r.value?.checkList?.length||0),1),e[8]||(e[8]=Q(" 张图片。 ",-1))]),_:1}),w("div",Yl,[C(te,{type:"primary",round:"",plain:"",onClick:D},{default:h(()=>[...e[9]||(e[9]=[Q("全选",-1)])]),_:1}),C(te,{type:"success",round:"",plain:"",onClick:M},{default:h(()=>[...e[10]||(e[10]=[Q("反选",-1)])]),_:1}),C(te,{type:"danger",round:"",plain:"",onClick:O},{default:h(()=>[...e[11]||(e[11]=[Q("清空",-1)])]),_:1})])])]),default:h(()=>[w("div",{class:"image-grid-container",onScroll:f},[C(zl,{ref_key:"List",ref:r,ImageInfo:g.value,total:o.value.length},null,8,["ImageInfo","total"]),p.value?(k(),A("div",Kl,[C(x,{class:"is-loading"},{default:h(()=>[C(a(mt))]),_:1}),e[12]||(e[12]=Q(" 加载中... ",-1))])):ie("",!0),g.value.length>=o.value.length&&o.value.length>0?(k(),A("div",Xl," 已加载全部图片 ")):ie("",!0)],32)]),_:1})]),w("div",ql,[C(F,{shadow:"hover",class:"flex-card selected-panel"},{header:h(()=>[...e[13]||(e[13]=[w("div",{class:"panel-header"},[w("span",{class:"panel-title"},"已选择的图片")],-1),w("div",{class:"panel-subtitle"},"拖拽图片可调整顺序,点击缩略图可查看预览",-1)])]),footer:h(()=>[w("div",lo,[C(i,{modelValue:H.value,"onUpdate:modelValue":e[3]||(e[3]=I=>H.value=I),clearable:"",placeholder:"请选择拼接方式",class:"stitching-select"},{default:h(()=>[(k(!0),A(xe,null,Ae(a(K),I=>(k(),G(m,{key:I.name,label:I.name,value:I.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),C(te,{disabled:r.value?.checkList.length==0,onClick:de,type:"primary",round:"",class:"generate-btn"},{default:h(()=>[...e[15]||(e[15]=[Q("生成拼接图",-1)])]),_:1},8,["disabled"])])]),default:h(()=>[w("div",Gl,[r.value?.checkList?.length===0?(k(),A("div",Jl,[...e[14]||(e[14]=[w("h3",null,"当前未选择任何图片",-1)])])):(k(),A("div",Zl,[C(a(Yt),{onChange:b,list:r.value?.checkList,"ghost-class":"ghost","chosen-class":"chosenClass",animation:"300",onStart:e[1]||(e[1]=I=>E.value=!0),onEnd:e[2]||(e[2]=I=>E.value=!1),"item-key":"id"},{item:h(({element:I,index:X})=>[w("div",Ql,[w("li",null,[w("span",eo,[C(Y,{class:"thumbnail",src:Z(I),"preview-src-list":Se(I),fit:"cover","hide-on-click-modal":"","preview-teleported":"",lazy:""},null,8,["src","preview-src-list"])]),w("span",to,ge(V(I)),1),C(te,{onClick:le=>j(X),text:"",type:"danger",icon:a(pt),circle:"",size:"small",class:"delete-btn"},null,8,["onClick","icon"])])])]),_:1},8,["list"])]))])]),_:1})]),w("div",null,[C(R,{modelValue:J.value,"onUpdate:modelValue":e[4]||(e[4]=I=>J.value=I),title:"拼接结果",width:"75%",draggable:"",class:"result-dialog"},{default:h(()=>[C(ae),w("div",oo,[w("canvas",so,null,512),W.value?(k(),G(Y,{key:0,src:W.value,fit:"contain",class:"result-image","preview-src-list":[W.value],"hide-on-click-modal":"","preview-teleported":"",lazy:""},null,8,["src","preview-src-list"])):(k(),A("div",no,[...e[16]||(e[16]=[w("p",null,"请先生成拼接图",-1)])]))])]),_:1},8,["modelValue"])])])}}}),fo=Ge(ao,[["__scopeId","data-v-be6c9cf6"]]);export{fo as default};
