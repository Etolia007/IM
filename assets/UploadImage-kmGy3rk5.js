import"./el-popper-cYwa1dRB.js";import{a as b,b as y,E as I,P as _,N as w,Q as F}from"./ImageInfo-BIPmNbR6.js";import{d as x,g as d,b as E,e as p,o as i,E as l,G as m,J as N,w as V,F as k,K as D,c as B,H as C,_ as T}from"./index-WTDxWk-M.js";const U=x({__name:"UploadImage",setup(S){const n=d(""),s=d(""),t=d(null),c=E(()=>b.filter(a=>a!=="全部")),v=a=>{const e=a.target;e.files&&e.files[0]&&(t.value=e.files[0])},f=a=>a.split(".").slice(0,-1).join(".")||a,g=async()=>{if(!t.value){n.value="请选择图片文件";return}if(!s.value){n.value="请选择图片类型";return}try{const a=new FileReader;a.onload=async e=>{const r=e.target?.result,u=f(t.value?.name||"未命名图片");await _.images.add({name:u,type:s.value,data:r,filename:t.value?.name||"",uploadedAt:new Date}),n.value=`图片 ${u} 添加成功`,s.value="",t.value=null,await w(),await F()},a.readAsDataURL(t.value)}catch(a){n.value=`添加图片失败: ${a}`}};return(a,e)=>{const r=y,u=I;return i(),p("fieldset",null,[e[3]||(e[3]=l("legend",null,"添加新图片",-1)),l("label",null,[e[1]||(e[1]=m(" 类型: ",-1)),N(u,{modelValue:s.value,"onUpdate:modelValue":e[0]||(e[0]=o=>s.value=o),clearable:"",placeholder:"请选择图片类型"},{default:V(()=>[(i(!0),p(k,null,D(c.value,o=>(i(),B(r,{key:o,label:o,value:o},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),e[4]||(e[4]=l("br",null,null,-1)),l("label",null,[e[2]||(e[2]=m(" 图片文件: ",-1)),l("input",{type:"file",onChange:v,accept:"image/*"},null,32)]),e[5]||(e[5]=l("br",null,null,-1)),l("button",{onClick:g},"添加图片"),l("p",null,C(n.value),1)])}}}),$=T(U,[["__scopeId","data-v-eea81ebd"]]);export{$ as default};
